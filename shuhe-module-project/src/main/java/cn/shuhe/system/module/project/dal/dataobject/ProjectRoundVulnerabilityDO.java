package cn.shuhe.system.module.project.dal.dataobject;

import cn.shuhe.system.framework.mybatis.core.dataobject.BaseDO;
import com.baomidou.mybatisplus.annotation.KeySequence;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;
import lombok.*;

import java.time.LocalDate;
import java.time.LocalDateTime;

/**
 * 轮次漏洞 DO
 * 
 * 记录每个轮次发现的漏洞信息
 */
@TableName("project_round_vulnerability")
@KeySequence("project_round_vulnerability_seq")
@Data
@EqualsAndHashCode(callSuper = true)
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class ProjectRoundVulnerabilityDO extends BaseDO {

    /**
     * 漏洞ID
     */
    @TableId
    private Long id;

    /**
     * 轮次ID
     */
    private Long roundId;

    /**
     * 项目ID
     */
    private Long projectId;

    /**
     * 目标ID（关联测试目标）
     */
    private Long targetId;

    // ========== 漏洞基本信息 ==========

    /**
     * 漏洞位置（标题/名称）
     */
    private String location;

    /**
     * 漏洞URL
     */
    private String url;

    /**
     * 危害程度：high/medium/low
     */
    private String severity;

    /**
     * 漏洞类型（如：SQL注入、XSS等）
     */
    private String type;

    /**
     * 漏洞过程描述（富文本HTML）
     */
    private String process;

    // ========== 漏洞类型详情 ==========

    /**
     * 漏洞类型说明
     */
    private String typeDescription;

    /**
     * 修复建议
     */
    private String typeAdvice;

    // ========== 复测信息 ==========

    /**
     * 复测状态：fixed/unfixed/partially-fixed
     */
    private String retestStatus;

    /**
     * 复测报告内容（富文本HTML）
     */
    private String retestReport;

    /**
     * 复测日期
     */
    private LocalDate retestDate;

    /**
     * 复测时间
     */
    private LocalDateTime retestTime;

}
