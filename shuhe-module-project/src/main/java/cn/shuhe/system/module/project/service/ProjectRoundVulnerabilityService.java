package cn.shuhe.system.module.project.service;

import cn.shuhe.system.module.project.controller.admin.vo.ProjectRoundVulnerabilitySaveReqVO;
import cn.shuhe.system.module.project.dal.dataobject.ProjectRoundVulnerabilityDO;
import jakarta.validation.Valid;

import java.time.LocalDate;
import java.util.List;
import java.util.Map;

/**
 * 轮次漏洞 Service 接口
 */
public interface ProjectRoundVulnerabilityService {

    /**
     * 创建漏洞
     *
     * @param createReqVO 创建信息
     * @return 漏洞ID
     */
    Long createVulnerability(@Valid ProjectRoundVulnerabilitySaveReqVO createReqVO);

    /**
     * 更新漏洞
     *
     * @param updateReqVO 更新信息
     */
    void updateVulnerability(@Valid ProjectRoundVulnerabilitySaveReqVO updateReqVO);

    /**
     * 删除漏洞
     *
     * @param id 漏洞ID
     */
    void deleteVulnerability(Long id);

    /**
     * 获取漏洞
     *
     * @param id 漏洞ID
     * @return 漏洞
     */
    ProjectRoundVulnerabilityDO getVulnerability(Long id);

    /**
     * 获取轮次的漏洞列表
     *
     * @param roundId 轮次ID
     * @return 漏洞列表
     */
    List<ProjectRoundVulnerabilityDO> getVulnerabilityListByRoundId(Long roundId);

    /**
     * 获取目标的漏洞列表
     *
     * @param targetId 目标ID
     * @return 漏洞列表
     */
    List<ProjectRoundVulnerabilityDO> getVulnerabilityListByTargetId(Long targetId);

    /**
     * 获取轮次的漏洞统计
     *
     * @param roundId 轮次ID
     * @return 统计信息 {total, high, medium, low}
     */
    Map<String, Long> getVulnerabilityStatsByRoundId(Long roundId);

    /**
     * 更新复测信息
     *
     * @param id 漏洞ID
     * @param retestStatus 复测状态
     * @param retestReport 复测报告
     * @param retestDate 复测日期
     */
    void updateRetestInfo(Long id, String retestStatus, String retestReport, LocalDate retestDate);

}
